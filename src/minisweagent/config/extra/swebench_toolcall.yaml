agent:
  system_template: |
    You are a helpful assistant that can interact with a computer shell to solve programming tasks.
  instance_template: |
    <pr_description>
    Consider the following PR description:
    {{task}}
    </pr_description>

    <instructions>
    # Task Instructions

    ## Overview

    You're a software engineer interacting continuously with a computer by submitting commands.
    You'll be helping implement necessary changes to meet requirements in the PR description.
    Your task is specifically to make changes to non-test files in the current directory in order to fix the issue described in the PR description in a way that is general and consistent with the codebase.

    ## Important Boundaries

    - MODIFY: Regular source code files in /testbed (this is the working directory for all your subsequent commands)
    - DO NOT MODIFY: Tests, configuration files (pyproject.toml, setup.cfg, etc.)

    ## Recommended Workflow

    1. Analyze the codebase by finding and reading relevant files
    2. Create a script to reproduce the issue
    3. Edit the source code to resolve the issue
    4. Verify your fix works by running your script again
    5. Test edge cases to ensure your fix is robust

    ## Important Rules

    1. Directory or environment variable changes are not persistent. Every action is executed in a new subshell.
       However, you can prefix any action with `MY_ENV_VAR=MY_VALUE cd /path/to/working/dir && ...` or write/load environment variables from files

    ## Environment Details

    - You have a full Linux shell environment
    - Always use non-interactive flags (-y, -f) for commands
    - Avoid interactive tools like vi, nano, or any that require user input
    - You can use bash commands or invoke any tool that is available in the environment
    - You can also create new tools or scripts to help you with the task
    - If a tool isn't available, you can also install it

    ## Submission

    When you've completed your work, submit your changes as a git patch.

    To submit your output you must issue a command that prints your git patch followed by COMPLETE_TASK_AND_SUBMIT_FINAL_OUTPUT.

    <CRITICAL>
    COMPLETE_TASK_AND_SUBMIT_FINAL_OUTPUT must be the exact last line. No output is allowed to follow it.
    Only the git patch is allowed to precede it. No other output is allowed to be included.
    </CRITICAL>

    We STRONGLY recommend the following strategy:

    Step 1: Create a git patch and verify it contains the correct changes
    Save a git diff of your changes to patch.txt. Only include source files you modified.
    We recommend you view patch.txt and verify it contains the correct changes to only the files outlined below.

    <IMPORTANT>
    You must only add the specific source files you modified to fix the issue.
    Do not submit changes to any of the following files:

    - test files
    - helper scripts, tests, or tools that you created
    - installation, build, packaging, configuration, or setup scripts unless they are directly part of the issue you were fixing (you can assume that the environment is already set up for your client)
    - binary or compiled files
    </IMPORTANT>

    Step 2
    Only after verifying in your previous command, use this EXACT standalone command to submit:

    ```bash
    cat patch.txt && echo COMPLETE_TASK_AND_SUBMIT_FINAL_OUTPUT
    ```

    If the command fails (nonzero exit status), it will not submit.

    <CRITICAL>
    Creating/viewing the patch and submitting it MUST be separate commands (not combined with &&)
    If you modify patch.txt after verifying, you SHOULD verify again before submitting
    Your command immediately before submit MUST be viewing/verifying patch.txt
    You CANNOT continue working (reading, editing, testing) in any way on this task after submitting
    </CRITICAL>
    </instructions>
  step_limit: 250
  cost_limit: 3.

environment:
  cwd: "/testbed"
  timeout: 60
  env:
    PAGER: cat
    MANPAGER: cat
    LESS: -R
    PIP_PROGRESS_BAR: 'off'
    TQDM_DISABLE: '1'
  environment_class: docker

model:
  observation_template: |
    {%- if output.output | length < 10000 -%}
    {
      "returncode": {{ output.returncode }},
      "output": {{ output.output | tojson }}
      {%- if output.exception_info %}, "exception_info": {{ output.exception_info | tojson }}{% endif %}
    }
    {%- else -%}
    {
      "returncode": {{ output.returncode }},
      "output_head": {{ output.output[:5000] | tojson }},
      "output_tail": {{ output.output[-5000:] | tojson }},
      "elided_chars": {{ output.output | length - 10000 }},
      "warning": "Output too long."
      {%- if output.exception_info %}, "exception_info": {{ output.exception_info | tojson }}{% endif %}
    }
    {%- endif -%}
  format_error_template: |
    Please always provide EXACTLY ONE action in triple backticks, found {{actions|length}} actions.
    If you want to end the task, please issue the following command: `echo COMPLETE_TASK_AND_SUBMIT_FINAL_OUTPUT`
    without any other command.
    Else, please format your response exactly as follows:

    <response_example>
    Here are some thoughts about why you want to perform the action.

    ```mswea_bash_command
    <action>
    ```
    </response_example>

    Note: In rare cases, if you need to reference a similar format in your command, you might have
    to proceed in two steps, first writing TRIPLEBACKTICKSBASH, then replacing them with ```mswea_bash_command.
  model_name: "anthropic/claude-sonnet-4-5-20250929"
  model_kwargs:
    drop_params: true
    temperature: 0.0
